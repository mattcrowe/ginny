<?php
namespace {{ model.bundle }}\Seeder;
/**
 * Generated by Ginny on {{ 'now'|date('m/d/Y h:i A') }}
 *
 * https://github.com/mattcrowe/ginny
 */

use DB;
use Illuminate\Database\Seeder;

class {{ model.bundle }}{{ model }}Seeder extends Seeder {

    public function run()
    {
    	DB::table('{{ model.table }}')->delete();

{% set uniques = {
'email': 'email',
'user': 'userName',
'username': 'userName',
} %}

        {% set fakes = {
        'first_name': 'firstName',
        'mi': 'randomLetter',
        'last_name': 'lastName',
        'name': 'words(rand(1, 3), true)',
        'host': 'domainName',
        'endpoint': 'url',
        'slug': 'word()',
        'salt': 'md5',
        'hash': 'md5',
        'token': 'md5',
        'pass': 'md5',
        'password': 'md5',
        'signature': 'md5',
        'secret': 'md5',
        'params': 'words(rand(3, 5), true)',
        'description': 'sentence()',
        'ip': 'ipv4',
        } %}

        {% for relation in model.belongsTo %}
            $key{{ loop.index }} = '{{ relation.local_key }}';
            $count{{ loop.index }} = ${{ relation.snakes }} = \{{ relation.parent.bundle }}\Model\{{ relation.parent }}::count();
        {% endfor %}

$faker = \Faker\Factory::create();

\{{ model.bundle }}\Model\{{ model }}::truncate();

foreach (range(1, $count1) as $index1) {
foreach (range(1, $count2) as $index2) {
\{{ model.bundle }}\Model\{{ model }}::create([

$key1 => $index1,
$key2 => $index2,

{% for field in model.dataFields %}

    {% filter inline %}

    {% if uniques[field.name] is defined %}
        {{ "'%s' => $faker->unique()->%s," | format(field.name, uniques[field.name]) }}
    {% elseif fakes[field.name] is defined %}
        {{ "'%s' => $faker->%s," | format(field.name, fakes[field.name]) }}
    {% elseif field.relation == true and field.belongsTo is defined %}
        {{ "'%s' => ceil($index/5)," | format(field.name) }}
    {% elseif field.name == 'data' %}
        {{ "'%s' => json_encode(['id'=>1])," | format(field.name) }}
    {% elseif field.type == 'boolean' %}
        {{ "'%s' => $faker->numberBetween(0, 1)," | format(field.name) }}
    {% elseif field.type == 'datetime' %}
        {{ "'%s' => $faker->dateTimeBetween('-1 year', 'now')," | format(field.name) }}
    {% elseif field.type == 'string' %}
        {{ "'%s' => $faker->word()," | format(field.name) }}
    {% else %}
        {{ "'%s' => '111'," | format(field.name) }}
    {% endif %}

    {% endfilter %}

{% endfor %}

]);
}
}

}

}