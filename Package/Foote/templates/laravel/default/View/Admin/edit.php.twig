@extends('admin.main')

@section('breadcrumb-links')
{% if model.parent != false %}
    <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
            {{ model.parent.plural }} <span class="caret"></span>
        </a>
        <ul class="dropdown-menu" role="menu">
            <li><a href="{{ blade_url(model.parent) }}">{{ i('list') }} List</a></li>
            <li><a href="{{ blade_url(model.parent, 'create') }}">{{ i('+') }} Add</a></li>
        </ul>
    </li>
{% endif %}
<li class="dropdown">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
        {{ model.plural }} <span class="caret"></span>
    </a>
    <ul class="dropdown-menu" role="menu">
        <li><a href="{{ blade_url(model) }}">{{ i('list') }} List</a></li>
        <li><a href="{{ blade_url(model, 'create') }}">{{ i('+') }} Add</a></li>
    </ul>
</li>
<li class="dropdown">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown">{{ model | blade }} <span class="caret"></span></a>
    <ul class="dropdown-menu" role="menu">
        {% if model.owns == true %}
            {% for relation in model.hasOne %}
                <li><a href="{{ blade_url(relation.child) }}">{{ i('list') }} {{ relation.plural }}</a></li>
            {% endfor %}
            {% for relation in model.hasMany %}
                <li><a href="{{ blade_url(relation.child) }}">{{ i('list') }} {{ relation.plural }}</a></li>
            {% endfor %}
        {% endif %}
        <li class="divider"></li>
        <li><a href="{{ blade_url(model, 'destroy') }}">{{ i('destroy') }} Delete</a></li>
    </ul>
</li>
<li class="no-crumb pull-right"><a class="btn btn-default btn-xs" href="{{ blade_url(model, 'show') }}">{{ i('cancel') }}<span class="hidden-xs"> cancel</span></a>
<li class="no-crumb pull-right">&nbsp;</li>
<li class="no-crumb pull-right"><button
            class="btn btn-default btn-xs"
            type="submit"
            form="main-form"
            name="_task[save-and-close]"
            value="save-close"><i
                class="fa fa-pencil-square-o"></i><span class="hidden-xs"> save &amp; close</span></button></li>
<li class="no-crumb pull-right">&nbsp;</li>
<li class="no-crumb pull-right"><button
            class="btn btn-success btn-xs"
            type="submit"
            form="main-form"
            name="_task=save"
            value="save"><i
                class="fa fa-pencil-square-o"></i><span class="hidden-xs"> save</span></button></li>
<li class="no-crumb">&nbsp;</li>
@stop

@section('content')

{% set pattern = "
{{ Form::model($%s, [
'url' => [%s],
'method' => 'PUT',
'class' => 'validate',
'id' => 'main-form',
]) }}" %}

{{ pattern | format(model.variable, blade_url(model, 'update', false)) }}

<div class="row">

    <div class="col-sm-6">
        {% for relation in model.belongsTo %}
            <div class="form-group">
                <label for="{{ relation.parent.variable }}">{{ relation.parent.title }}</label>
                {% filter inline %}
                {{ "{{ Form::select('%s', $%s, Input::get('%s'), ['class'=>'form-control']) }}" | format(relation.local_key, relation.parent.variables, relation.local_key) }}
                {% endfilter %}
            </div>
        {% endfor %}
        {% for field in model.dataFields %}
            <div class="form-group">
                <label for="{{ field.variable }}">{{ field.title }}</label>
                {% filter inline %}
                {% if field.type == 'datetime' %}
                    {{ "{{ Form::input('datetime-local', '%s', Input::get('%s'), ['class'=>'form-control']) }}" | format(field, field) }}
                {% elseif field.type == 'boolean' %}
                    {{ "{{ Form::hidden('%s', false, ['class'=>'form-control']) }}" | format(field) }}
                    {{ "{{ Form::checkbox('%s', true, ['class'=>'form-control']) }}" | format(field) }}
                {% elseif field.type == 'text' %}
                    {{ "{{ Form::textarea('%s', Input::get('%s'), ['class'=>'form-control']) }}" | format(field, field) }}
                {% elseif field.name == 'email' %}
                    {{ "{{ Form::email('%s', Input::get('%s'), ['class'=>'form-control']) }}" | format(field, field) }}
                {% else %}
                    {{ "{{ Form::text('%s', Input::get('%s'), ['class'=>'form-control']) }}" | format(field, field) }}
                {% endif %}

                {% endfilter %}
            </div>
        {% endfor %}
    </div>

</div>

{{ '{{ Form::close() }}' }}

@endsection